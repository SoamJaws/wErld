<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>/home/travis/build/SoamJaws/wErld/test/logs/ct_run.test@testing-worker-linux-docker-f40c940c-3427-linux-11.2016-08-14_20.18.26/weather_controller.COVER.html</title>
</head><body style='background-color: white; color: black'>
<pre>
File generated from /home/travis/build/SoamJaws/wErld/ebin/../src/client/weather_controller.erl by COVER 2016-08-14 at 20:18:28

****************************************************************************

        |  -module(weather_controller).
        |  -include("weather.hrl").
        |  -include("time.hrl").
        |  -behaviour(gen_server).
        |  -behaviour(time_subscriber).
        |  
        |  %% Public API
        |  -export([ ?GET_TYPE/0
        |          , ?GET_TEMP/0]).
        |  
        |  %% Time subscriber
        |  -export([ ?NEW_TIME/2
        |          , ?NEW_TIME/3]).
        |  
        |  %% gen_server
        |  -export([ start_link/2
        |          , init/1
        |          , handle_call/3
        |          , handle_cast/2
        |          , handle_info/2
        |          , terminate/2
        |          , code_change/3]).
        |  
        |  %% Public API
        |  
        |  -spec ?GET_TYPE() -&gt; weather_type().
        |  ?GET_TYPE() -&gt;
<font color=red>     0..|    ets_utils:set_lookup(?MODULE, type).</font>
        |  
        |  -spec ?GET_TEMP() -&gt; integer().
        |  ?GET_TEMP() -&gt;
<font color=red>     0..|    ets_utils:set_lookup(?MODULE, temp).</font>
        |  
        |  
        |  %% Time subscriber
        |  
        |  -spec ?NEW_TIME({global, weather_controller}, time()) -&gt; ok.
        |  ?NEW_TIME(Address, Time) -&gt;
<font color=red>     0..|    ?NEW_TIME(Address, Time, false).</font>
        |  
        |  -spec ?NEW_TIME({global, weather_controller}, time(), boolean()) -&gt; ok.
        |  ?NEW_TIME(Address, Time, BlockCaller) -&gt;
<font color=red>     0..|    gen_server_utils:cast(Address, {?NEW_TIME, Time}, BlockCaller).</font>
        |  
        |  
        |  %% gen_server
        |  
        |  -spec start_link(atom(), pos_integer()) -&gt; {ok, pid()} | ignore | {error, {already_started, pid()} | any()}.
        |  start_link(City, UpdateInterval) -&gt;
<font color=red>     0..|    gen_server:start(?MODULE, [City, UpdateInterval], []).</font>
        |  
        |  
        |  -spec init({atom(), pos_integer()}) -&gt; {ok, weather_controller_state()}.
        |  init({City, UpdateInterval}) -&gt;
<font color=red>     0..|    Pid = self(),</font>
<font color=red>     0..|    Id = weather_controller,</font>
<font color=red>     0..|    time:?SUBSCRIBE(?RECIPENT),</font>
<font color=red>     0..|    Time = time:?GET_CURRENT_TIME(),</font>
<font color=red>     0..|    ets:new(?MODULE, [named_table]),</font>
<font color=red>     0..|    ets:insert(?MODULE, {type, sunny}),</font>
<font color=red>     0..|    ets:insert(?MODULE, {temp, 20}),</font>
<font color=red>     0..|    { ok, #weather_controller_state{ city=City</font>
        |                                   , updateInterval=UpdateInterval
        |                                   , lastChange=Time
        |                                   } }.
        |  
        |  
        |  -spec handle_call(any(), {pid(), any()}, weather_controller_state()) -&gt; {reply, ok, weather_controller_state()}.
        |  handle_call(_Msg, _From, State) -&gt;
<font color=red>     0..|    {reply, ok, State}.</font>
        |  
        |  
        |  -spec handle_cast({?NEW_TIME, time(), boolean(), pid()}, weather_controller_state()) -&gt; {noreply, weather_controller_state()}.
        |  handle_cast({?NEW_TIME, Time, NotifyCaller, Caller}, State) -&gt;
<font color=red>     0..|    UpdatedState = if</font>
        |                     Time - State#weather_controller_state.lastChange &gt;= State#weather_controller_state.updateInterval -&gt;
        |                       %% Change weather if should be done
        |                       %% Change temp according to statistical temp and time of day
<font color=red>     0..|                       State#weather_controller_state{lastChange=Time};</font>
        |                     true -&gt;
<font color=red>     0..|                       State</font>
        |                   end,
<font color=red>     0..|    gen_server_utils:notify_caller(NotifyCaller, Caller),</font>
<font color=red>     0..|    {noreply, UpdatedState}.</font>
        |  
        |  
        |  -spec handle_info(timeout | any(), weather_controller_state()) -&gt; {noreply, weather_controller_state()}.
        |  handle_info(_Info, State) -&gt;
<font color=red>     0..|    {noreply, State}.</font>
        |  
        |  
        |  -spec terminate(normal | shutdown | {shutdown, any()} | any(), weather_controller_state()) -&gt; ok.
        |  terminate(_Reason, _State) -&gt;
<font color=red>     0..|    ok.</font>
        |  
        |  
        |  -spec code_change(term() | {down, term()}, weather_controller_state(), term()) -&gt; {ok, weather_controller_state()}.
        |  code_change(_OldVsn, State, _Extra) -&gt;
<font color=red>     0..|    {ok, State}.</font>
        |  
        |  %% Backend
        |  
        |  %% Gothenburg
        |  -spec get_coastal_stats() -&gt; [monthly_stats()].
<font color=red>     0..|  get_coastal_stats() -&gt; [ #monthly_stats{maxTemp=1,  minTemp=-4, sunHours=1, rainDays=15}</font>
        |                         , #monthly_stats{maxTemp=1,  minTemp=-4, sunHours=2, rainDays=11}
        |                         , #monthly_stats{maxTemp=5,  minTemp=-2, sunHours=3, rainDays=12}
        |                         , #monthly_stats{maxTemp=9,  minTemp=2,  sunHours=5, rainDays=11}
        |                         , #monthly_stats{maxTemp=16, minTemp=7,  sunHours=7, rainDays=11}
        |                         , #monthly_stats{maxTemp=19, minTemp=11, sunHours=8, rainDays=11}
        |                         , #monthly_stats{maxTemp=20, minTemp=12, sunHours=8, rainDays=11}
        |                         , #monthly_stats{maxTemp=20, minTemp=12, sunHours=7, rainDays=12}
        |                         , #monthly_stats{maxTemp=16, minTemp=9,  sunHours=5, rainDays=14}
        |                         , #monthly_stats{maxTemp=11, minTemp=6,  sunHours=3, rainDays=15}
        |                         , #monthly_stats{maxTemp=6,  minTemp=1,  sunHours=2, rainDays=16}
        |                         , #monthly_stats{maxTemp=3,  minTemp=-2, sunHours=1, rainDays=15}
        |                         ].
        |  
        |  %% Karlstad
        |  -spec get_inland_stats() -&gt; [monthly_stats()].
<font color=red>     0..|  get_inland_stats() -&gt; [ #monthly_stats{maxTemp=-2, minTemp=-8, sunHours=1, rainDays=17}</font>
        |                        , #monthly_stats{maxTemp=-1, minTemp=-9, sunHours=2, rainDays=13}
        |                        , #monthly_stats{maxTemp=3,  minTemp=-5, sunHours=3, rainDays=13}
        |                        , #monthly_stats{maxTemp=8,  minTemp=-1, sunHours=5, rainDays=12}
        |                        , #monthly_stats{maxTemp=15, minTemp=5,  sunHours=7, rainDays=12}
        |                        , #monthly_stats{maxTemp=20, minTemp=9,  sunHours=9, rainDays=13}
        |                        , #monthly_stats{maxTemp=21, minTemp=11, sunHours=8, rainDays=15}
        |                        , #monthly_stats{maxTemp=20, minTemp=10, sunHours=7, rainDays=14}
        |                        , #monthly_stats{maxTemp=15, minTemp=7,  sunHours=4, rainDays=16}
        |                        , #monthly_stats{maxTemp=10, minTemp=3,  sunHours=3, rainDays=16}
        |                        , #monthly_stats{maxTemp=4,  minTemp=-2, sunHours=1, rainDays=17}
        |                        , #monthly_stats{maxTemp=0,  minTemp=-7, sunHours=1, rainDays=17}
        |                        ].
        |  
        |  %% Luleå
        |  -spec get_northern_stats() -&gt; [monthly_stats()].
<font color=red>     0..|  get_northern_stats() -&gt; [ #monthly_stats{maxTemp=-8, minTemp=-16, sunHours=0,  rainDays=16}</font>
        |                          , #monthly_stats{maxTemp=-8, minTemp=-16, sunHours=1,  rainDays=14}
        |                          , #monthly_stats{maxTemp=-2, minTemp=-11, sunHours=3,  rainDays=13}
        |                          , #monthly_stats{maxTemp=3,  minTemp=-4,  sunHours=5,  rainDays=10}
        |                          , #monthly_stats{maxTemp=10, minTemp=2,   sunHours=8,  rainDays=10}
        |                          , #monthly_stats{maxTemp=17, minTemp=8,   sunHours=10, rainDays=10}
        |                          , #monthly_stats{maxTemp=19, minTemp=11,  sunHours=9,  rainDays=11}
        |                          , #monthly_stats{maxTemp=17, minTemp=10,  sunHours=6,  rainDays=13}
        |                          , #monthly_stats{maxTemp=12, minTemp=5,   sunHours=4,  rainDays=15}
        |                          , #monthly_stats{maxTemp=6,  minTemp=1,   sunHours=2,  rainDays=15}
        |                          , #monthly_stats{maxTemp=-1, minTemp=-7,  sunHours=1,  rainDays=16}
        |                          , #monthly_stats{maxTemp=-5, minTemp=-13, sunHours=0,  rainDays=16}
        |                          ].
        |  
        |  %% Malmö
        |  -spec get_southern_stats() -&gt; [monthly_stats()].
<font color=red>     0..|  get_southern_stats() -&gt; [ #monthly_stats{maxTemp=2,  minTemp=-2, sunHours=1, rainDays=17}</font>
        |                          , #monthly_stats{maxTemp=2,  minTemp=-3, sunHours=2, rainDays=13}
        |                          , #monthly_stats{maxTemp=4,  minTemp=-1, sunHours=3, rainDays=14}
        |                          , #monthly_stats{maxTemp=9,  minTemp=2,  sunHours=6, rainDays=13}
        |                          , #monthly_stats{maxTemp=15, minTemp=7,  sunHours=8, rainDays=12}
        |                          , #monthly_stats{maxTemp=19, minTemp=11, sunHours=8, rainDays=12}
        |                          , #monthly_stats{maxTemp=20, minTemp=13, sunHours=8, rainDays=14}
        |                          , #monthly_stats{maxTemp=20, minTemp=13, sunHours=7, rainDays=14}
        |                          , #monthly_stats{maxTemp=17, minTemp=10, sunHours=5, rainDays=15}
        |                          , #monthly_stats{maxTemp=12, minTemp=7,  sunHours=3, rainDays=15}
        |                          , #monthly_stats{maxTemp=7,  minTemp=3,  sunHours=2, rainDays=17}
        |                          , #monthly_stats{maxTemp=3,  minTemp=-1, sunHours=1, rainDays=17}
        |                          ].
</pre>
</body>
</html>
